<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬ - ÙˆØ³ÙŠÙ„ Ù…Ø§Ø±ÙƒØª</title>
    <meta name="description" content="Ø§ÙƒØªØ´Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø±Ø§Ø¦Ø¹ ÙÙŠ Ù…ØªØ¬Ø± ÙˆØ³ÙŠÙ„ Ù…Ø§Ø±ÙƒØª">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ÙˆØ³ÙŠÙ„ Ù…Ø§Ø±ÙƒØª - Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±">
    <meta property="og:description" content="Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù…ØªØ¬Ø± ÙˆØ³ÙŠÙ„ Ù…Ø§Ø±ÙƒØª">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://wacelmarkt.com">
    <meta property="og:image" content="https://wacelmarkt.com/images/logo.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/style.css">
    
    <style>
        /* Ø£Ù†Ù…Ø§Ø· Ø®Ø§ØµØ© Ø¨ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© */
        .share-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .share-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .share-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .product-share-header {
            padding: 50px 40px;
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            text-align: center;
            position: relative;
        }
        
        .share-back-btn {
            position: absolute;
            top: 25px;
            right: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .share-back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(-5px);
        }
        
        .share-product-image {
            width: 200px;
            height: 200px;
            margin: 0 auto 25px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 4px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .share-product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .share-product-image i {
            font-size: 4rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .share-product-info h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: white;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .share-product-category {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 1rem;
            display: inline-block;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .share-product-description {
            font-size: 1.2rem;
            line-height: 1.7;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .share-product-details {
            padding: 40px;
        }
        
        .share-price-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 16px;
            border: 2px solid #e2e8f0;
        }
        
        .current-price {
            font-size: 3rem;
            font-weight: bold;
            color: #10b981;
            display: block;
        }
        
        .original-price {
            font-size: 1.5rem;
            color: #94a3b8;
            text-decoration: line-through;
            margin: 0 15px;
        }
        
        .discount-badge {
            background: linear-gradient(135deg, #f59e0b, #eab308);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            display: inline-block;
            margin-top: 10px;
        }
        
        .share-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-item {
            text-align: center;
            padding: 25px 15px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .feature-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 1.5rem;
        }
        
        .share-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }
        
        .share-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
        }
        
        .btn-whatsapp {
            background: #25D366;
            color: white;
        }
        
        .btn-facebook {
            background: #1877F2;
            color: white;
        }
        
        .btn-twitter {
            background: #1DA1F2;
            color: white;
        }
        
        .btn-copy {
            background: #6366f1;
            color: white;
        }
        
        .btn-buy-now {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            font-size: 1.1rem;
        }
        
        .btn-visit-store {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            grid-column: 1 / -1;
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }
        
        .share-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        .share-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 30px 0;
            padding: 25px;
            background: #f8fafc;
            border-radius: 16px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #6366f1;
            display: block;
        }
        
        .stat-label {
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .product-specifications {
            margin: 30px 0;
            padding: 25px;
            background: white;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }
        
        .specs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .spec-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .spec-item:last-child {
            border-bottom: none;
        }
        
        .spec-key {
            font-weight: 600;
            color: #1e293b;
        }
        
        .spec-value {
            color: #475569;
        }
        
        .loading-state, .error-state {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .loading-state i, .error-state i {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .loading-state i {
            color: #6366f1;
        }
        
        .error-state i {
            color: #ef4444;
        }
        
        .temp-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            border-left: 4px solid #10b981;
        }
        
        .temp-message.error {
            border-left-color: #ef4444;
        }
        
        @media (max-width: 768px) {
            .product-share-header {
                padding: 40px 20px;
            }
            
            .share-product-info h1 {
                font-size: 2rem;
            }
            
            .current-price {
                font-size: 2.5rem;
            }
            
            .share-product-details {
                padding: 20px;
            }
            
            .share-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="share-page">
    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <nav class="top-navbar">
        <div class="nav-container">
            <div class="logo-section">
                <a href="index.html" style="text-decoration: none;">
                    <h1 class="logo"><i class="fas fa-shopping-bag"></i> ÙˆØ³ÙŠÙ„ Ù…Ø§Ø±ÙƒØª</h1>
                </a>
            </div>
        </div>
    </nav>

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© -->
    <div class="share-container">
        <div id="shareContent">
            <div class="loading-state">
                <i class="fas fa-spinner fa-spin"></i>
                <h2>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬...</h2>
                <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† URL
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('product');
        let currentProduct = null;

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù†
        async function loadSharedProduct() {
            try {
                if (!productId) {
                    throw new Error('Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…Ù†ØªØ¬ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©');
                }
                
                console.log("ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬:", productId);
                
                let product = null;

                // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© 1: Ø¬Ù„Ø¨ Ù…Ù† localStorage Ø£ÙˆÙ„Ø§Ù‹
                const savedProduct = localStorage.getItem('sharedProduct_' + productId);
                if (savedProduct) {
                    try {
                        product = JSON.parse(savedProduct);
                        console.log("ğŸ“± ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† localStorage:", product.name);
                    } catch (e) {
                        console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† localStorage:", e);
                    }
                }

                // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© 2: Ø¬Ù„Ø¨ Ù…Ù† Firebase
                if (!product && window.firebaseDb && typeof firebaseDb.collection === 'function') {
                    try {
                        console.log("ğŸ”¥ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Firebase...");
                        const doc = await firebaseDb.collection("products").doc(productId).get();
                        if (doc.exists) {
                            product = {
                                id: doc.id,
                                ...doc.data()
                            };
                            // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„Ù…Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
                            localStorage.setItem('sharedProduct_' + productId, JSON.stringify(product));
                            console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Firebase:", product.name);
                        }
                    } catch (firebaseError) {
                        console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Firebase:", firebaseError);
                    }
                }

                // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© 3: Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
                if (!product && window.allProducts && Array.isArray(window.allProducts)) {
                    product = window.allProducts.find(p => p.id === productId);
                    if (product) {
                        console.log("ğŸ“ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ allProducts:", product.name);
                    }
                }

                if (!product) {
                    throw new Error('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ø­Ø°ÙˆÙ.');
                }

                currentProduct = product;
                
                // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ Ù„Ù„SEO
                updateMetaTags(product);
                
                // Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
                displayShareContent(product);

            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬:', error);
                showErrorState(error.message);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ
        function updateMetaTags(product) {
            document.title = `${product.name} - ÙˆØ³ÙŠÙ„ Ù…Ø§Ø±ÙƒØª`;
            
            const metaDescription = document.querySelector('meta[name="description"]');
            if (metaDescription) {
                metaDescription.content = `${product.description.substring(0, 160)}...`;
            }
            
            // ØªØ­Ø¯ÙŠØ« Open Graph
            updateMetaProperty('og:title', product.name);
            updateMetaProperty('og:description', product.description);
            updateMetaProperty('og:url', window.location.href);
            
            if (product.images && product.images.length > 0) {
                updateMetaProperty('og:image', product.images[0]);
            }
        }
        
        function updateMetaProperty(property, content) {
            let meta = document.querySelector(`meta[property="${property}"]`);
            if (!meta) {
                meta = document.createElement('meta');
                meta.setAttribute('property', property);
                document.head.appendChild(meta);
            }
            meta.setAttribute('content', content);
        }

        // Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        function displayShareContent(product) {
            const shareUrl = window.location.href;
            const shareText = `ØªÙØ¶Ù„ Ø¨ØªÙØ­Øµ "${product.name}" - ${product.description.substring(0, 100)}...`;
            
            const productImage = product.images && product.images.length > 0 
                ? `<img src="${product.images[0]}" alt="${product.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<i class=\\'${getProductIcon(product.category)}\\'></i>'">`
                : `<i class="${getProductIcon(product.category)}"></i>`;
            
            const originalPriceHtml = product.originalPrice 
                ? `<span class="original-price">${product.originalPrice} Ø±.Ø³</span>`
                : '';
            
            const discountBadge = product.discount 
                ? `<div class="discount-badge">ØªØ®ÙÙŠØ¶ ${product.discount}%</div>`
                : '';
            
            const specificationsHtml = product.specifications && Object.keys(product.specifications).length > 0 ? `
                <div class="product-specifications">
                    <h3><i class="fas fa-list-alt"></i> Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù…Ù†ØªØ¬</h3>
                    <div class="specs-grid">
                        ${Object.entries(product.specifications).map(([key, value]) => `
                            <div class="spec-item">
                                <span class="spec-key">${key}</span>
                                <span class="spec-value">${value}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            ` : '';

            document.getElementById('shareContent').innerHTML = `
                <div class="share-card">
                    <div class="product-share-header">
                        <a href="index.html" class="share-back-btn">
                            <i class="fas fa-arrow-right"></i>
                            Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ØªØ¬Ø±
                        </a>
                        
                        <div class="share-product-image">
                            ${productImage}
                        </div>
                        
                        <div class="share-product-info">
                            <h1>${product.name}</h1>
                            <div class="share-product-category">${getCategoryName(product.category)}</div>
                            <p class="share-product-description">${product.description}</p>
                        </div>
                    </div>
                    
                    <div class="share-product-details">
                        <div class="share-price-section">
                            <span class="current-price">${product.price} Ø±.Ø³</span>
                            ${originalPriceHtml}
                            ${discountBadge}
                        </div>
                        
                        <div class="share-features">
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fas fa-shipping-fast"></i>
                                </div>
                                <h4>Ø´Ø­Ù† Ø³Ø±ÙŠØ¹</h4>
                                <p>ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 2-3 Ø£ÙŠØ§Ù…</p>
                            </div>
                            
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h4>Ø¶Ù…Ø§Ù† Ø§Ù„Ø¬ÙˆØ¯Ø©</h4>
                                <p>Ø¶Ù…Ø§Ù† 30 ÙŠÙˆÙ… Ù„Ù„Ø¥Ø±Ø¬Ø§Ø¹</p>
                            </div>
                            
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fas fa-headset"></i>
                                </div>
                                <h4>Ø¯Ø¹Ù… ÙÙ†ÙŠ</h4>
                                <p>Ø¯Ø¹Ù… Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©</p>
                            </div>
                        </div>
                        
                        <div class="share-stats">
                            <div class="stat-item">
                                <span class="stat-number">${product.rating || '--'}</span>
                                <span class="stat-label">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">${product.sales || 0}</span>
                                <span class="stat-label">Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">${product.stock || 0}</span>
                                <span class="stat-label">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">${product.discount ? product.discount + '%' : '--'}</span>
                                <span class="stat-label">Ø§Ù„ØªØ®ÙÙŠØ¶</span>
                            </div>
                        </div>
                        
                        ${specificationsHtml}
                        
                        <div class="share-actions">
                            <button class="share-btn btn-whatsapp" onclick="shareOnWhatsApp('${shareText}', '${shareUrl}')">
                                <i class="fab fa-whatsapp"></i>
                                ÙˆØ§ØªØ³Ø§Ø¨
                            </button>
                            
                            <button class="share-btn btn-facebook" onclick="shareOnFacebook('${shareUrl}')">
                                <i class="fab fa-facebook"></i>
                                ÙÙŠØ³Ø¨ÙˆÙƒ
                            </button>
                            
                            <button class="share-btn btn-twitter" onclick="shareOnTwitter('${shareText}', '${shareUrl}')">
                                <i class="fab fa-twitter"></i>
                                ØªÙˆÙŠØªØ±
                            </button>
                            
                            <button class="share-btn btn-copy" onclick="copyShareLink('${shareUrl}')">
                                <i class="fas fa-link"></i>
                                Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
                            </button>
                            
                            <button class="share-btn btn-buy-now" onclick="buyNowFromShare()" ${product.stock <= 0 ? 'disabled' : ''}>
                                <i class="fas fa-bolt"></i>
                                ${product.stock <= 0 ? 'ØºÙŠØ± Ù…ØªÙˆÙØ±' : 'Ø´Ø±Ø§Ø¡ Ø³Ø±ÙŠØ¹'}
                            </button>
                            
                            <a href="index.html" class="share-btn btn-visit-store">
                                <i class="fas fa-store"></i>
                                Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ØªØ¬Ø±
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ù†ØªØ¬
        function getProductIcon(category) {
            const icons = {
                'electronics': 'fas fa-laptop',
                'fashion': 'fas fa-tshirt',
                'home': 'fas fa-home',
                'beauty': 'fas fa-spa',
                'sports': 'fas fa-running',
                'books': 'fas fa-book',
                'food': 'fas fa-utensils',
                'health': 'fas fa-heartbeat'
            };
            return icons[category] || 'fas fa-shopping-bag';
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ØªØµÙ†ÙŠÙ
        function getCategoryName(category) {
            const categories = {
                'electronics': 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',
                'fashion': 'Ù…ÙˆØ¶Ø©',
                'home': 'Ø§Ù„Ù…Ù†Ø²Ù„',
                'beauty': 'Ø§Ù„Ø¬Ù…Ø§Ù„',
                'sports': 'Ø±ÙŠØ§Ø¶Ø©',
                'books': 'ÙƒØªØ¨',
                'food': 'Ø·Ø¹Ø§Ù…',
                'health': 'ØµØ­Ø©'
            };
            return categories[category] || category;
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
        function shareOnWhatsApp(text, url) {
            const shareUrl = `https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`;
            window.open(shareUrl, '_blank');
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
        function shareOnFacebook(url) {
            const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
            window.open(shareUrl, '_blank');
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ØªÙˆÙŠØªØ±
        function shareOnTwitter(text, url) {
            const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
            window.open(shareUrl, '_blank');
        }

        // Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        function copyShareLink(url) {
            navigator.clipboard.writeText(url).then(() => {
                showTempMessage('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
            }).catch(() => {
                // Fallback for older browsers
                const tempInput = document.createElement('input');
                tempInput.value = url;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                showTempMessage('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
            });
        }

        // Ø´Ø±Ø§Ø¡ Ø³Ø±ÙŠØ¹ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        function buyNowFromShare() {
            if (!currentProduct) {
                showTempMessage('âŒ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ù„Ø´Ø±Ø§Ø¡', 'error');
                return;
            }
            
            if (currentProduct.stock <= 0) {
                showTempMessage('âŒ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†', 'error');
                return;
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const existingItem = cart.find(item => item.id === currentProduct.id);
            
            if (existingItem) {
                if (existingItem.quantity >= currentProduct.stock) {
                    showTempMessage('âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ÙƒÙ…ÙŠØ© Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†', 'error');
                    return;
                }
                existingItem.quantity += 1;
            } else {
                cart.push({
                    ...currentProduct,
                    quantity: 1
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            
            showTempMessage('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©', 'success');
            
            // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ·
            setTimeout(() => {
                window.location.href = 'checkout.html';
            }, 1500);
        }

        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù…Ø¤Ù‚ØªØ©
        function showTempMessage(text, type) {
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø±Ø³Ø§Ø¦Ù„ Ø³Ø§Ø¨Ù‚Ø©
            const existingMessages = document.querySelectorAll('.temp-message');
            existingMessages.forEach(msg => msg.remove());
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `temp-message ${type === 'error' ? 'error' : ''}`;
            messageDiv.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check' : 'exclamation'}-circle"></i>
                <span>${text}</span>
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.style.opacity = '0';
                messageDiv.style.transition = 'opacity 0.3s ease';
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                }, 300);
            }, 3000);
        }

        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
        function showErrorState(message) {
            document.getElementById('shareContent').innerHTML = `
                <div class="error-state">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h2>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬</h2>
                    <p>${message}</p>
                    <div style="margin-top: 20px;">
                        <a href="index.html" class="share-btn btn-visit-store" style="display: inline-block; text-decoration: none;">
                            <i class="fas fa-store"></i>
                            Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…ØªØ¬Ø±
                        </a>
                    </div>
                </div>
            `;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log("ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©...");
            loadSharedProduct();
        });

        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ù† Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
        window.getProductIcon = getProductIcon;
        window.getCategoryName = getCategoryName;
    </script>
</body>
</html>
